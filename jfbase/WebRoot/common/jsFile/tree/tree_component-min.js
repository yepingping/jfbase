(function(b){b.fn.tree=function(c){return this.each(function(){var d=b.extend({},c);if(a.inst&&a.inst[b(this).attr("id")]){a.inst[b(this).attr("id")].destroy()}if(d!==false){new a().init(this,d)}})};b.tree_create=function(){return new a()};b.tree_focused=function(){return a.inst[a.focused]};b.tree_reference=function(c){return a.inst[c]||null};b.tree_rollback=function(f){for(var e in f){if(typeof f[e]=="function"){continue}var d=a.inst[e];var c=!d.locked;if(c){d.lock(true)}if(d.inp){d.inp.val("").blur()}d.context.append=false;d.container.html(f[e].html).find(".dragged").removeClass("dragged").end().find("div.context").remove();if(f[e].selected){d.selected=b("#"+f[e].selected);d.selected_arr=[];d.container.find("a.clicked").each(function(){d.selected_arr.push(d.get_node(this))})}if(c){d.lock(false)}delete c;delete d}};function a(){if(typeof a.inst=="undefined"){a.cntr=0;a.inst={};a.drag_drop={isdown:false,drag_node:false,drag_help:false,init_x:false,init_y:false,moving:false,origin_tree:false,marker:false,move_type:false,ref_node:false,appended:false,foreign:false,droppable:[],open_time:false,scroll_time:false};a.mousedown=function(d){var c=b(d.target);if(a.drag_drop.droppable.length&&c.is("."+a.drag_drop.droppable.join(", ."))){a.drag_drop.drag_help=b("<div id='jstree-dragged' class='tree tree-default'><ul><li class='last dragged foreign "+d.target.className+"'><a href='#'>"+c.text()+"</a></li></ul></div>");a.drag_drop.drag_node=a.drag_drop.drag_help.find("li:eq(0)");a.drag_drop.isdown=true;a.drag_drop.foreign=c;c.blur();d.preventDefault();d.stopPropagation();return false}d.stopPropagation();return true};a.mouseup=function(e){var d=a.drag_drop;if(d.open_time){clearTimeout(d.open_time)}if(d.scroll_time){clearTimeout(d.scroll_time)}if(d.foreign===false&&d.drag_node&&d.drag_node.size()){d.drag_help.remove();if(d.move_type){var c=a.inst[d.ref_node.parents(".tree:eq(0)").attr("id")];if(c){c.moved(d.origin_tree.container.find("li.dragged"),d.ref_node,d.move_type,false,(d.origin_tree.settings.rules.drag_copy=="on"||(d.origin_tree.settings.rules.drag_copy=="ctrl"&&e.ctrlKey)))}}d.move_type=false;d.ref_node=false}if(d.drag_node&&d.foreign!==false){d.drag_help.remove();if(d.move_type){var c=a.inst[d.ref_node.parents(".tree:eq(0)").attr("id")];if(c){c.settings.callback.ondrop.call(null,d.foreign.get(0),c.get_node(d.ref_node).get(0),d.move_type,c)}}d.foreign=false;d.move_type=false;d.ref_node=false}a.drag_drop.marker.hide();d.drag_help=false;d.drag_node=false;d.isdown=false;d.init_x=false;d.init_y=false;d.moving=false;d.appended=false;b("li.dragged").removeClass("dragged");d.origin_tree=false;e.preventDefault();e.stopPropagation();return false};a.mousemove=function(c){var g=a.drag_drop;if(g.isdown){if(!g.moving&&Math.abs(g.init_x-c.pageX)<5&&Math.abs(g.init_y-c.pageY)<5){c.preventDefault();c.stopPropagation();return false}else{a.drag_drop.moving=true}if(g.open_time){clearTimeout(g.open_time)}if(!g.appended){if(g.foreign!==false){g.origin_tree=b.tree_focused()}b("body").append(g.drag_help);g.w=g.drag_help.width();g.appended=true}g.drag_help.css({left:(c.pageX-(g.origin_tree.settings.ui.rtl?g.w:-5)),top:(c.pageY+15)});if(c.target.tagName=="IMG"&&c.target.id=="marker"){return false}var j=b(c.target);var e=j.is(".tree")?j:j.parents(".tree:eq(0)");if(e.size()==0||!a.inst[e.attr("id")]){if(g.scroll_time){clearTimeout(g.scroll_time)}if(g.drag_help.find("IMG").size()==0){g.drag_help.find("li:eq(0)").append("<img style='position:absolute; "+(g.origin_tree.settings.ui.rtl?"right":"left")+":4px; top:0px; background:white; padding:2px;' src='"+g.origin_tree.settings.ui.theme_path+"remove.png' />")}g.move_type=false;g.ref_node=false;a.drag_drop.marker.hide();return false}var k=a.inst[e.attr("id")];k.off_height();if(g.foreign===false&&g.origin_tree.container.get(0)!=k.container.get(0)&&(!g.origin_tree.settings.rules.multitree||!k.settings.rules.multitree)){if(g.drag_help.find("IMG").size()==0){g.drag_help.find("li:eq(0)").append("<img style='position:absolute; "+(g.origin_tree.settings.ui.rtl?"right":"left")+":4px; top:0px; background:white; padding:2px;' src='"+g.origin_tree.settings.ui.theme_path+"remove.png' />")}g.move_type=false;g.ref_node=false;a.drag_drop.marker.hide();return false}if(g.scroll_time){clearTimeout(g.scroll_time)}g.scroll_time=setTimeout(function(){k.scrollCheck(c.pageX,c.pageY)},50);var l=false;var m=e.scrollTop();if(c.target.tagName=="A"){if(j.is("#jstree-dragged")){return false}if(k.get_node(c.target).hasClass("closed")){g.open_time=setTimeout(function(){k.open_branch(j)},500)}var f=j.offset();var d={x:(f.left-1),y:(c.pageY-f.top)};if(e.children("ul:eq(0)").hasClass("rtl")){d.x+=j.width()-8}var h=[];if(d.y<k.li_height/3+1){h=["before","inside","after"]}else{if(d.y>k.li_height*2/3-1){h=["after","inside","before"]}else{if(d.y<k.li_height/2){h=["inside","before","after"]}else{h=["inside","after","before"]}}}var i=false;b.each(h,function(n,o){if(k.checkMove(g.origin_tree.container.find("li.dragged"),j,o)){l=o;i=true;return false}});if(i){switch(l){case"before":d.y=f.top-2;if(e.children("ul:eq(0)").hasClass("rtl")){a.drag_drop.marker.attr("src",k.settings.ui.theme_path+"marker_rtl.gif").width(40)}else{a.drag_drop.marker.attr("src",k.settings.ui.theme_path+"marker.gif").width(40)}break;case"after":d.y=f.top-2+k.li_height;if(e.children("ul:eq(0)").hasClass("rtl")){a.drag_drop.marker.attr("src",k.settings.ui.theme_path+"marker_rtl.gif").width(40)}else{a.drag_drop.marker.attr("src",k.settings.ui.theme_path+"marker.gif").width(40)}break;case"inside":d.x-=2;if(e.children("ul:eq(0)").hasClass("rtl")){d.x+=36}d.y=f.top-2+k.li_height/2;a.drag_drop.marker.attr("src",k.settings.ui.theme_path+"plus.gif").width(11);break}g.move_type=l;g.ref_node=b(c.target);g.drag_help.find("IMG").remove();a.drag_drop.marker.css({left:d.x,top:d.y}).show()}}if((j.is(".tree")||j.is("ul"))&&j.find("li:eq(0)").size()==0){var f=j.offset();g.move_type="inside";g.ref_node=e.children("ul:eq(0)");g.drag_help.find("IMG").remove();a.drag_drop.marker.attr("src",k.settings.ui.theme_path+"plus.gif").width(11);a.drag_drop.marker.css({left:f.left+(e.children("ul:eq(0)").hasClass("rtl")?(e.width()-10):10),top:f.top+15}).show()}else{if(c.target.tagName!="A"||!i){if(g.drag_help.find("IMG").size()==0){g.drag_help.find("li:eq(0)").append("<img style='position:absolute; "+(g.origin_tree.settings.ui.rtl?"right":"left")+":4px; top:0px; background:white; padding:2px;' src='"+g.origin_tree.settings.ui.theme_path+"remove.png' />")}g.move_type=false;g.ref_node=false;a.drag_drop.marker.hide()}}c.preventDefault();c.stopPropagation();return false}return true}}return{cntr:++a.cntr,settings:{data:{type:"predefined",method:"GET",async:false,async_data:function(c,d){return{id:b(c).attr("id")||0}},url:false,json:false,xml:false},selected:false,opened:[],languages:[],path:false,cookies:false,ui:{dots:true,rtl:false,animation:0,hover_mode:true,scroll_spd:4,theme_path:false,theme_name:"default",context:[{id:"create",label:"Create",icon:"create.png",visible:function(c,d){if(c.length!=1){return false}return d.check("creatable",c)},action:function(c,d){d.create(false,d.get_node(c[0]))}},"separator",{id:"rename",label:"Rename",icon:"rename.png",visible:function(c,d){if(c.length!=1){return false}return d.check("renameable",c)},action:function(c,d){d.rename(c)}},{id:"delete",label:"Delete",icon:"remove.png",visible:function(c,d){var e=true;b.each(c,function(){if(d.check("deletable",this)==false){e=false}return false});return e},action:function(c,d){b.each(c,function(){d.remove(this)})}}]},rules:{multiple:false,metadata:false,type_attr:"rel",multitree:false,createat:"bottom",use_inline:false,clickable:"all",renameable:"all",deletable:"all",creatable:"all",draggable:"none",dragrules:"all",drag_copy:false,droppable:[],drag_button:"left"},lang:{new_node:"New folder",loading:"Loading ..."},callback:{beforechange:function(c,d){return true},beforeopen:function(c,d){return true},beforeclose:function(c,d){return true},beforemove:function(c,e,f,d){return true},beforecreate:function(c,e,f,d){return true},beforerename:function(c,e,d){return true},beforedelete:function(c,d){return true},onJSONdata:function(c,d){return c},onselect:function(c,d){},ondeselect:function(c,d){},onchange:function(c,d){},onrename:function(c,e,d,f){},onmove:function(c,e,g,d,f){},oncopy:function(c,e,g,d,f){},oncreate:function(c,e,g,d,f){},ondelete:function(c,d,e){},onopen:function(c,d){},onopen_all:function(c){},onclose:function(c,d){},error:function(d,c){},ondblclk:function(c,d){d.toggle_branch.call(d,c);d.select_branch.call(d,c)},onrgtclk:function(c,d,e){},onload:function(c){},onfocus:function(c){},ondrop:function(c,e,f,d){}}},init:function(h,d){var k=this;this.container=b(h);if(this.container.size==0){alert("Invalid container node!");return}a.inst[this.cntr]=this;if(!this.container.attr("id")){this.container.attr("id","jstree_"+this.cntr)}a.inst[this.container.attr("id")]=a.inst[this.cntr];a.focused=this.cntr;var g=b.extend({},d);if(g&&g.cookies){this.settings.cookies=b.extend({},this.settings.cookies,g.cookies);delete g.cookies;if(!this.settings.cookies.opts){this.settings.cookies.opts={}}}if(g&&g.callback){this.settings.callback=b.extend({},this.settings.callback,g.callback);delete g.callback}if(g&&g.data){this.settings.data=b.extend({},this.settings.data,g.data);delete g.data}if(g&&g.ui){this.settings.ui=b.extend({},this.settings.ui,g.ui);delete g.ui}if(g&&g.rules){this.settings.rules=b.extend({},this.settings.rules,g.rules);delete g.rules}if(g&&g.lang){this.settings.lang=b.extend({},this.settings.lang,g.lang);delete g.lang}this.settings=b.extend({},this.settings,g);if(this.settings.path==false){this.path="";b("script").each(function(){if(this.src.toString().match(/tree_component.*?js$/)){k.path=this.src.toString().replace(/tree_component.*?js$/,"")}})}else{this.path=this.settings.path}this.current_lang=this.settings.languages&&this.settings.languages.length?this.settings.languages[0]:false;if(this.settings.languages&&this.settings.languages.length){this.sn=get_sheet_num("tree_component.css");if(this.sn===false&&document.styleSheets.length){this.sn=document.styleSheets.length}var c=false;var j=this.container.attr("id")?"#"+this.container.attr("id"):".tree";for(var f=0;f<this.settings.languages.length;f++){c=add_css(j+" ."+this.settings.languages[f],this.sn);if(c!==false){if(this.settings.languages[f]==this.current_lang){c.style.display=""}else{c.style.display="none"}}}}if(this.settings.rules.droppable.length){for(var e in this.settings.rules.droppable){if(typeof this.settings.rules.droppable[e]=="function"){continue}a.drag_drop.droppable.push(this.settings.rules.droppable[e])}a.drag_drop.droppable=b.unique(a.drag_drop.droppable)}if(this.settings.ui.theme_path===false){this.settings.ui.theme_path=this.path+"themes/"}this.theme=this.settings.ui.theme_path;if(k.settings.ui.theme_name){this.theme+=k.settings.ui.theme_name+"/";if(k.settings.ui.theme_name!="themeroller"&&!a.def_style){add_sheet(k.settings.ui.theme_path+"default/style.css");a.def_style=true}add_sheet(k.theme+"style.css")}this.container.addClass("tree");if(k.settings.ui.theme_name!="themeroller"){this.container.addClass("tree-default")}if(this.settings.ui.theme_name&&this.settings.ui.theme_name!="default"){this.container.addClass("tree-"+k.settings.ui.theme_name)}if(this.settings.ui.theme_name=="themeroller"){this.container.addClass("ui-widget ui-widget-content")}if(this.settings.rules.multiple){this.selected_arr=[]}this.offset=false;this.context_menu();this.hovered=false;this.locked=false;if(this.settings.rules.draggable!="none"&&a.drag_drop.marker===false){var k=this;a.drag_drop.marker=b("<img>").attr({id:"marker",src:k.settings.ui.theme_path+"marker.gif"}).css({height:"5px",width:"40px",display:"block",position:"absolute",left:"30px",top:"30px",zIndex:"1000"}).hide().appendTo("body")}this.refresh();this.attachEvents();this.focus()},off_height:function(){if(this.offset===false){this.container.css({position:"relative"});this.offset=this.container.offset();var c=0;c=parseInt(b.curCSS(this.container.get(0),"paddingTop",true),10);if(c){this.offset.top+=c}c=parseInt(b.curCSS(this.container.get(0),"borderTopWidth",true),10);if(c){this.offset.top+=c}}if(!this.li_height){var c=this.container.find("ul li.closed, ul li.leaf").eq(0);this.li_height=c.height();if(c.children("ul:eq(0)").size()){this.li_height-=c.children("ul:eq(0)").height()}if(!this.li_height){this.li_height=18}}},context_menu:function(){this.context=false;if(this.settings.ui.context!=false){var e='<div class="tree-context tree-default-context tree-'+this.settings.ui.theme_name+'-context">';for(var c in this.settings.ui.context){if(typeof this.settings.ui.context[c]=="function"){continue}if(this.settings.ui.context[c]=="separator"){e+="<span class='separator'>&nbsp;</span>";continue}var d="";if(this.settings.ui.context[c].icon){d="background-image:url('"+(this.settings.ui.context[c].icon.indexOf("/")==-1?this.theme+this.settings.ui.context[c].icon:this.settings.ui.context[c].icon)+"');"}e+='<a rel="'+this.settings.ui.context[c].id+'" href="#" style="'+d+'">'+this.settings.ui.context[c].label+"</a>"}e+="</div>";this.context=b(e);this.context.hide();this.context.append=false}},refresh:function(f){if(this.locked){return this.error("LOCKED")}var h=this;this.is_partial_refresh=f?true:false;this.opened=Array();if(this.settings.cookies&&b.cookie(this.settings.cookies.prefix+"_open")){var g=b.cookie(this.settings.cookies.prefix+"_open");var e=g.split(",");b.each(e,function(){if(this.replace(/^#/,"").length>0){h.opened.push("#"+this.replace(/^#/,""))}});this.settings.opened=false}else{if(this.settings.opened!=false){b.each(this.settings.opened,function(j,k){if(this.replace(/^#/,"").length>0){h.opened.push("#"+this.replace(/^#/,""))}});this.settings.opened=false}else{this.container.find("li.open").each(function(j){if(this.id){h.opened.push("#"+this.id)}})}}if(this.selected){this.settings.selected=Array();if(f){b(f).find("li:has(a.clicked)").each(function(){$this=b(this);if($this.attr("id")){h.settings.selected.push("#"+$this.attr("id"))}})}else{if(this.selected_arr){b.each(this.selected_arr,function(){if(this.attr("id")){h.settings.selected.push("#"+this.attr("id"))}})}else{if(this.selected.attr("id")){this.settings.selected.push("#"+this.selected.attr("id"))}}}}else{if(this.settings.cookies&&b.cookie(this.settings.cookies.prefix+"_selected")){this.settings.selected=Array();var g=b.cookie(this.settings.cookies.prefix+"_selected");var e=g.split(",");b.each(e,function(){if(this.replace(/^#/,"").length>0){h.settings.selected.push("#"+this.replace(/^#/,""))}})}else{if(this.settings.selected!==false){var e=Array();if((typeof this.settings.selected).toLowerCase()=="object"){b.each(this.settings.selected,function(){if(this.replace(/^#/,"").length>0){e.push("#"+this.replace(/^#/,""))}})}else{if(this.settings.selected.replace(/^#/,"").length>0){e.push("#"+this.settings.selected.replace(/^#/,""))}}this.settings.selected=e}}}if(f&&this.settings.data.async){this.opened=Array();f=this.get_node(f);f.find("li.open").each(function(j){h.opened.push("#"+this.id)});if(f.hasClass("open")){f.removeClass("open").addClass("closed")}if(f.hasClass("leaf")){f.removeClass("leaf")}f.children("ul:eq(0)").html("");return this.open_branch(f,true,function(){h.reselect.apply(h)})}if(this.settings.data.type=="xml_flat"||this.settings.data.type=="xml_nested"){this.scrtop=this.container.get(0).scrollTop;var d=(this.settings.data.type=="xml_flat")?"flat.xsl":"nested.xsl";if(this.settings.data.xml){this.container.getTransform(this.path+d,this.settings.data.xml,{params:{theme_name:h.settings.ui.theme_name,theme_path:h.theme},meth:h.settings.data.method,dat:h.settings.data.async_data.apply(h,[f,h]),callback:function(){h.context_menu.apply(h);h.reselect.apply(h)}})}else{this.container.getTransform(this.path+d,this.settings.data.url,{params:{theme_name:h.settings.ui.theme_name,theme_path:h.theme},meth:h.settings.data.method,dat:h.settings.data.async_data.apply(h,[f,h]),callback:function(){h.context_menu.apply(h);h.reselect.apply(h)}})}return}else{if(this.settings.data.type=="json"){if(this.settings.data.json){var g="";if(this.settings.data.json.length){for(var c=0;c<this.settings.data.json.length;c++){g+=this.parseJSON(this.settings.data.json[c])}}else{g=this.parseJSON(this.settings.data.json)}this.container.html("<ul>"+g+"</ul>");this.container.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed");this.container.find("li").not(".open").not(".closed").addClass("leaf");this.context_menu();this.reselect()}else{var h=this;b.akfAjax({type:this.settings.data.method,url:this.settings.data.url,data:this.settings.data.async_data(false,this),dataType:"json",success:function(k){k=h.settings.callback.onJSONdata.call(null,k,h);var l="";if(k.length){for(var j=0;j<k.length;j++){l+=h.parseJSON(k[j])}}else{l=h.parseJSON(k)}h.container.html("<ul>"+l+"</ul>");h.container.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed");h.container.find("li").not(".open").not(".closed").addClass("leaf");h.context_menu.apply(h);h.reselect.apply(h)},error:function(j,k,i){h.error(i+" "+k)}})}}else{this.container.children("ul:eq(0)");this.container.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed");this.container.find("li").not(".open").not(".closed").addClass("leaf");this.reselect()}}},parseJSON:function(g){if(!g||!g.data){return""}var k="";k+="<li ";var d=false;if(g.attributes){for(var f in g.attributes){if(typeof g.attributes[f]=="function"){continue}if(f=="class"){k+=" class='"+g.attributes[f]+" ";if(g.state=="closed"||g.state=="open"){k+=" "+g.state+" "}k+="' ";d=true}else{k+=" "+f+"='"+g.attributes[f]+"' "}}}if(!d&&(g.state=="closed"||g.state=="open")){k+=" class='"+g.state+"' "}k+=">";if(this.settings.languages.length){for(var f=0;f<this.settings.languages.length;f++){var c={};c.href="#";c.style="";c["class"]=this.settings.languages[f];if(g.data[this.settings.languages[f]]&&(typeof g.data[this.settings.languages[f]].attributes).toLowerCase()!="undefined"){for(var e in g.data[this.settings.languages[f]].attributes){if(typeof g.data[this.settings.languages[f]].attributes[e]=="function"){continue}if(e=="style"||e=="class"){c[e]+=" "+g.data[this.settings.languages[f]].attributes[e]}else{c[e]=g.data[this.settings.languages[f]].attributes[e]}}}if(g.data[this.settings.languages[f]]&&g.data[this.settings.languages[f]].icon&&this.settings.theme_name!="themeroller"){var h=g.data[this.settings.languages[f]].icon.indexOf("/")==-1?this.theme+g.data[this.settings.languages[f]].icon:g.data[this.settings.languages[f]].icon;c.style+=" ; background-image:url('"+b.webPath+h+"'); "}k+="<a";for(var e in c){if(typeof c[e]=="function"){continue}k+=" "+e+'="'+c[e]+'" '}k+=">";if(g.data[this.settings.languages[f]]&&g.data[this.settings.languages[f]].icon&&this.settings.theme_name=="themeroller"){k+="<ins class='ui-icon "+g.data[this.settings.languages[f]].icon+"'>&nbsp;</ins>"}k+=((typeof g.data[this.settings.languages[f]].title).toLowerCase()!="undefined"?g.data[this.settings.languages[f]].title:g.data[this.settings.languages[f]])+"</a>"}}else{var c={};c.href="#";c.style="";c["class"]="";if((typeof g.data.attributes).toLowerCase()!="undefined"){for(var f in g.data.attributes){if(typeof g.data.attributes[f]=="function"){continue}if(f=="style"||f=="class"){c[f]+=" "+g.data.attributes[f]}else{c[f]=g.data.attributes[f]}}}if(g.data.icon&&this.settings.ui.theme_name!="themeroller"){var h=g.data.icon.indexOf("/")==-1?this.theme+g.data.icon:g.data.icon;c.style+=" ; background-image:url('"+b.webPath+h+"');"}k+="<a";for(var f in c){if(typeof c[e]=="function"){continue}k+=" "+f+'="'+c[f]+'" '}k+=">";if(g.data.icon&&this.settings.ui.theme_name=="themeroller"){k+="<ins class='ui-icon "+g.data.icon+"'>&nbsp;</ins>"}k+=((typeof g.data.title).toLowerCase()!="undefined"?g.data.title:g.data)+"</a>"}if(g.children&&g.children.length){k+="<ul>";for(var f=0;f<g.children.length;f++){k+=this.parseJSON(g.children[f])}k+="</ul>"}k+="</li>";return k},getJSON:function(q,l,n,c){var m=this;if(!q||b(q).size()==0){q=this.container.children("ul").children("li")}else{q=b(q)}if(q.size()>1){var k=[];q.each(function(){k.push(m.getJSON(this,l,n,c))});return k}if(!l){l=["id","rel","class"]}if(!n){n=[]}var g={attributes:{},data:false};for(var h in l){if(typeof l[h]=="function"){continue}var d=(l[h]=="class")?q.attr(l[h]).replace("last","").replace("leaf","").replace("closed","").replace("open",""):q.attr(l[h]);if(typeof d!="undefined"&&d.replace(" ","").length>0){g.attributes[l[h]]=d}delete d}if(this.settings.languages.length){g.data={};for(var h in this.settings.languages){if(typeof this.settings.languages[h]=="function"){continue}var o=q.children("a."+this.settings.languages[h]);if(c||n.length||o.get(0).style.backgroundImage.toString().length){g.data[this.settings.languages[h]]={};g.data[this.settings.languages[h]].title=o.text();if(o.get(0).style.backgroundImage.length){g.data[this.settings.languages[h]].icon=o.get(0).style.backgroundImage.replace("url(","").replace(")","")}if(this.settings.ui.theme_name=="themeroller"&&o.children("ins").size()){var f=o.children("ins").attr("class");var p=false;b.each(f.split(" "),function(j,r){if(r.indexOf("ui-icon-")==0){p=r;return false}});if(p){g.data[this.settings.languages[h]].icon=p}}if(n.length){g.data[this.settings.languages[h]].attributes={};for(var e in n){if(typeof n[e]=="function"){continue}var d=o.attr(n[e]);if(typeof d!="undefined"&&d.replace(" ","").length>0){g.data[this.settings.languages[h]].attributes[n[e]]=d}delete d}}}else{g.data[this.settings.languages[h]]=o.text()}}}else{var o=q.children("a");if(c||n.length||o.get(0).style.backgroundImage.toString().length){g.data={};g.data.title=o.text();if(o.get(0).style.backgroundImage.length){g.data.icon=o.get(0).style.backgroundImage.replace("url(","").replace(")","")}if(this.settings.ui.theme_name=="themeroller"&&o.children("ins").size()){var f=o.children("ins").attr("class");var p=false;b.each(f.split(" "),function(j,r){if(r.indexOf("ui-icon-")==0){p=r;return false}});if(p){g.data[this.settings.languages[h]].icon=p}}if(n.length){g.data.attributes={};for(var e in n){if(typeof n[e]=="function"){continue}var d=o.attr(n[e]);if(typeof d!="undefined"&&d.replace(" ","").length>0){g.data.attributes[n[e]]=d}delete d}}}else{g.data=o.text()}}if(q.children("ul").size()>0){g.children=[];q.children("ul").children("li").each(function(){g.children.push(m.getJSON(this,l,n,c))})}return g},getXML:function(p,r,k,m,d){var l=this;if(p!="flat"){p="nested"}if(!r||b(r).size()==0){r=this.container.children("ul").children("li")}else{r=b(r)}if(r.size()>1){var h="<root>";r.each(function(){h+=l.getXML(p,this,k,m,true)});h+="</root>";return h}if(!k){k=["id","rel","class"]}if(!m){m=[]}var h="";if(!d){h="<root>"}h+="<item ";if(p=="flat"){var n=r.parents("li:eq(0)").size()?r.parents("li:eq(0)").attr("id"):0;h+=' parent_id="'+n+'" ';delete n}for(var g in k){if(typeof k[g]=="function"){continue}var c=(k[g]=="class")?r.attr(k[g]).replace("last","").replace("leaf","").replace("closed","").replace("open",""):r.attr(k[g]);if(typeof c!="undefined"&&c.replace(" ","").length>0){h+=" "+k[g]+'="'+c+'" '}delete c}h+=">";h+="<content>";if(this.settings.languages.length){for(var g in this.settings.languages){if(typeof this.settings.languages[g]=="function"){continue}var o=r.children("a."+this.settings.languages[g]);h+="<name ";if(m.length||o.get(0).style.backgroundImage.toString().length||this.settings.ui.theme_name=="themeroller"){if(o.get(0).style.backgroundImage.length){h+=' icon="'+o.get(0).style.backgroundImage.replace("url(","").replace(")","")+'" '}if(this.settings.ui.theme_name=="themeroller"&&o.children("ins").size()){var f=o.children("ins").attr("class");var q=false;b.each(f.split(" "),function(j,s){if(s.indexOf("ui-icon-")==0){q=s;return false}});if(q){h+=' icon="'+q+'" '}}if(m.length){for(var e in m){if(typeof m[e]=="function"){continue}var c=o.attr(m[e]);if(typeof c!="undefined"&&c.replace(" ","").length>0){h+=" "+m[e]+'="'+c+'" '}delete c}}}h+="><![CDATA["+o.text()+"]]></name>"}}else{var o=r.children("a");h+="<name ";if(m.length||o.get(0).style.backgroundImage.toString().length||this.settings.ui.theme_name=="themeroller"){if(o.get(0).style.backgroundImage.length){h+=' icon="'+o.get(0).style.backgroundImage.replace("url(","").replace(")","")+'" '}if(this.settings.ui.theme_name=="themeroller"&&o.children("ins").size()){var f=o.children("ins").attr("class");var q=false;b.each(f.split(" "),function(j,s){if(s.indexOf("ui-icon-")==0){q=s;return false}});if(q){h+=' icon="'+q+'" '}}if(m.length){for(var e in m){if(typeof m[e]=="function"){continue}var c=o.attr(m[e]);if(typeof c!="undefined"&&c.replace(" ","").length>0){h+=" "+m[e]+'="'+c+'" '}delete c}}}h+="><![CDATA["+o.text()+"]]></name>"}h+="</content>";if(p=="flat"){h+="</item>"}if(r.children("ul").size()>0){r.children("ul").children("li").each(function(){h+=l.getXML(p,this,k,m,true)})}if(p=="nested"){h+="</item>"}if(!d){h+="</root>"}return h},focus:function(){if(this.locked){return false}if(a.focused!=this.cntr){a.focused=this.cntr;this.settings.callback.onfocus.call(null,this)}},show_context:function(d){if(typeof this.context!="undefined"&&this.context&&this.context!=null){this.context.show();var c=b(d).children("a:visible").offset();this.context.css({left:(c.left),top:(c.top+parseInt(d.children("a:visible").height())+2)})}},hide_context:function(){if(typeof this.context!="undefined"&&this.context&&this.context!=null){if(this.context.to_remove&&this.context.apply_to){this.context.apply_to.children("a").removeClass("clicked")}this.context.apply_to=false;this.context.hide()}},attachEvents:function(){var c=this;this.container.bind("mousedown.jstree",function(d){if(a.drag_drop.isdown){a.drag_drop.move_type=false;d.preventDefault();d.stopPropagation();d.stopImmediatePropagation();return false}}).bind("mouseup.jstree",function(d){setTimeout(function(){c.focus.apply(c)},5)}).bind("click.jstree",function(d){return true});b("#"+this.container.attr("id")+" li").live("click",function(d){if(d.target.tagName!="LI"){return true}c.off_height();if(d.pageY-b(d.target).offset().top>c.li_height){return true}c.toggle_branch.apply(c,[d.target]);d.stopPropagation();return false});b("#"+this.container.attr("id")+" li a").live("click.jstree",function(d){if(d.which&&d.which==3){return true}if(c.locked){d.preventDefault();d.target.blur();return c.error("LOCKED")}c.select_branch.apply(c,[d.target,d.ctrlKey||c.settings.rules.multiple=="on"]);if(c.inp){c.inp.blur()}d.preventDefault();d.target.blur();return false}).live("dblclick.jstree",function(d){if(c.locked){d.preventDefault();d.stopPropagation();d.target.blur();return c.error("LOCKED")}c.settings.callback.ondblclk.call(null,c.get_node(d.target).get(0),c);d.preventDefault();d.stopPropagation();d.target.blur()}).live("contextmenu.jstree",function(f){if(c.locked){f.target.blur();return c.error("LOCKED")}var j=c.settings.callback.onrgtclk.call(null,c.get_node(f.target).get(0),c,f);if(c.context){if(c.context.append==false){b("body").append(c.context);c.context.append=true;for(var d in c.settings.ui.context){if(typeof c.settings.ui.context[d]=="function"){continue}if(c.settings.ui.context[d]=="separator"){continue}(function(){var i=c.settings.ui.context[d].action;c.context.children("[rel="+c.settings.ui.context[d].id+"]").bind("click",function(k){if(!b(this).hasClass("disabled")){i.call(null,c.context.apply_to||null,c);c.hide_context()}k.stopPropagation();k.preventDefault();return false}).bind("mouseup",function(k){this.blur();if(b(this).hasClass("disabled")){k.stopPropagation();k.preventDefault();return false}}).bind("mousedown",function(k){k.stopPropagation();k.preventDefault()})})()}}var h=c.get_node(f.target);if(c.inp){c.inp.blur()}if(h){if(!h.children("a:eq(0)").hasClass("clicked")){c.context.apply_to=h;c.context.to_remove=true;c.context.apply_to.children("a").addClass("clicked");f.target.blur()}else{c.context.to_remove=false;c.context.apply_to=(c.selected_arr&&c.selected_arr.length>1)?c.selected_arr:c.selected}c.context.children("a").removeClass("disabled").show();var e=false;for(var d in c.settings.ui.context){if(typeof c.settings.ui.context[d]=="function"){continue}if(c.settings.ui.context[d]=="separator"){continue}var g=c.settings.ui.context[d].visible.call(null,c.context.apply_to,c);if(g===false){c.context.children("[rel="+c.settings.ui.context[d].id+"]").addClass("disabled")}if(g===-1){c.context.children("[rel="+c.settings.ui.context[d].id+"]").hide()}else{e=true}}if(e==true){c.show_context(h)}f.preventDefault();f.stopPropagation();return false}}return j}).live("mouseover.jstree",function(d){if(c.locked){d.preventDefault();d.stopPropagation();return c.error("LOCKED")}if((c.settings.ui.hover_mode||c.settings.ui.theme_name=="themeroller")&&c.hovered!==false&&d.target.tagName=="A"){c.hovered.children("a").removeClass("hover ui-state-hover");c.hovered=false}if(c.settings.ui.theme_name=="themeroller"){c.hover_branch.apply(c,[d.target])}});if(c.settings.ui.theme_name=="themeroller"){b("#"+this.container.attr("id")+" li a").live("mouseout",function(d){if(c.hovered){c.hovered.children("a").removeClass("hover ui-state-hover")}})}if(this.settings.rules.draggable!="none"){b("#"+this.container.attr("id")+" li a").live("mousedown.jstree",function(g){if(c.settings.rules.drag_button=="left"&&g.which&&g.which!=1){return true}if(c.settings.rules.drag_button=="right"&&g.which&&g.which!=3){return true}c.focus.apply(c);if(c.locked){return c.error("LOCKED")}var h=c.get_node(g.target);if(c.settings.rules.multiple!=false&&c.selected_arr.length>1&&h.children("a:eq(0)").hasClass("clicked")){var d=0;for(var f in c.selected_arr){if(typeof c.selected_arr[f]=="function"){continue}if(c.check("draggable",c.selected_arr[f])){c.selected_arr[f].addClass("dragged");a.drag_drop.origin_tree=c;d++}}if(d>0){if(c.check("draggable",h)){a.drag_drop.drag_node=h}else{a.drag_drop.drag_node=c.container.find("li.dragged:eq(0)")}a.drag_drop.isdown=true;a.drag_drop.drag_help=b("<div id='jstree-dragged' class='tree "+(c.container.hasClass("tree-default")?" tree-default":"")+(c.settings.ui.theme_name&&c.settings.ui.theme_name!="default"?" tree-"+c.settings.ui.theme_name:"")+"' />").append("<ul class='"+c.container.children("ul:eq(0)").get(0).className+"' />");var e=b(a.drag_drop.drag_node.get(0).cloneNode(true));if(c.settings.languages.length>0){e.find("a").not("."+c.current_lang).hide()}a.drag_drop.drag_help.children("ul:eq(0)").append(e);a.drag_drop.drag_help.find("li:eq(0)").removeClass("last").addClass("last").children("a").html("Multiple selection").end().children("ul").remove()}}else{if(c.check("draggable",h)){a.drag_drop.drag_node=h;a.drag_drop.drag_help=b("<div id='jstree-dragged' class='tree "+(c.container.hasClass("tree-default")?" tree-default":"")+(c.settings.ui.theme_name&&c.settings.ui.theme_name!="default"?" tree-"+c.settings.ui.theme_name:"")+"' />").append("<ul class='"+c.container.children("ul:eq(0)").get(0).className+"' />");var e=b(h.get(0).cloneNode(true));if(c.settings.languages.length>0){e.find("a").not("."+c.current_lang).hide()}a.drag_drop.drag_help.children("ul:eq(0)").append(e);a.drag_drop.drag_help.find("li:eq(0)").removeClass("last").addClass("last");a.drag_drop.isdown=true;a.drag_drop.foreign=false;a.drag_drop.origin_tree=c;h.addClass("dragged")}}a.drag_drop.init_x=g.pageX;a.drag_drop.init_y=g.pageY;h.blur();g.preventDefault();g.stopPropagation();return false});b(document).bind("mousedown.jstree",a.mousedown).bind("mouseup.jstree",a.mouseup).bind("mousemove.jstree",a.mousemove)}if(c.context){b(document).bind("mousedown",function(){c.hide_context()})}},checkMove:function(m,d,k){if(this.locked){return this.error("LOCKED")}var j=this;if(d.parents("li.dragged").size()>0||d.is(".dragged")){return this.error("MOVE: NODE OVER SELF")}if(m.size()==1){var e=m.eq(0);if(a.drag_drop.foreign){if(this.settings.rules.droppable.length==0){return false}if(!e.is("."+this.settings.rules.droppable.join(", ."))){return false}var l=false;for(var h in this.settings.rules.droppable){if(typeof this.settings.rules.droppable[h]=="function"){continue}if(e.is("."+this.settings.rules.droppable[h])){if(this.settings.rules.metadata){b.metadata.setType("attr",this.settings.rules.metadata);e.attr(this.settings.rules.metadata,"type: '"+this.settings.rules.droppable[h]+"'")}else{e.attr(this.settings.rules.type_attr,this.settings.rules.droppable[h])}l=true;break}}if(!l){return false}}if(!this.check("dragrules",[e,k,d.parents("li:eq(0)")])){return this.error("MOVE: AGAINST DRAG RULES")}}else{var l=true;m.each(function(o){if(l==false){return false}var p=d;var n=k;if(!j.check.apply(j,["dragrules",[b(this),n,p]])){l=false}});if(l==false){return this.error("MOVE: AGAINST DRAG RULES")}}if(this.settings.rules.use_inline&&this.settings.rules.metadata){var f=false;if(k=="inside"){f=d.parents("li:eq(0)")}else{f=d.parents("li:eq(1)")}if(f.size()){if(typeof f.metadata()["valid_children"]!="undefined"){var g=f.metadata()["valid_children"];var l=true;m.each(function(n){if(l==false){return false}if(b.inArray(j.get_type(this),g)==-1){l=false}});if(l==false){return this.error("MOVE: NOT A VALID CHILD")}}if(typeof f.metadata()["max_children"]!="undefined"){if((f.children("ul:eq(0)").children("li").not(".dragged").size()+m.size())>f.metadata().max_children){return this.error("MOVE: MAX CHILDREN REACHED")}}var c=0;m.each(function(n){var p=1;var o=b(this);while(p<100){o=o.children("ul").children("li");if(o.size()==0){break}p++}c=Math.max(p,c)});var l=true;if((typeof b(f).metadata().max_depth).toLowerCase()!="undefined"&&b(f).metadata().max_depth<c){l=false}else{f.parents("li").each(function(n){if(l==false){return false}if((typeof b(this).metadata().max_depth).toLowerCase()!="undefined"){if((n+c)>=b(this).metadata().max_depth){l=false}}})}if(l==false){return this.error("MOVE: MAX_DEPTH REACHED")}}}return true},reselect:function(e){var g=this;if(!e){this.cl_count=0}else{this.cl_count--}if(this.opened&&this.opened.length){var f=false;for(var c=0;this.opened&&c<this.opened.length;c++){if(this.settings.data.async){if(this.get_node(this.opened[c]).size()>0){f=true;var d=this.opened[c];delete this.opened[c];this.open_branch(d,true,function(){g.reselect.apply(g,[true])});this.cl_count++}}else{this.open_branch(this.opened[c],true)}}if(this.settings.data.async&&f){return}delete this.opened}if(this.cl_count>0){return}if(this.settings.ui.rtl){this.container.css("direction","rtl").children("ul:eq(0)").addClass("rtl")}else{this.container.css("direction","ltr").children("ul:eq(0)").addClass("ltr")}if(this.settings.ui.dots==false){this.container.children("ul:eq(0)").addClass("no_dots")}if(this.scrtop){this.container.scrollTop(g.scrtop);delete this.scrtop}if(this.settings.selected!==false){b.each(this.settings.selected,function(h){if(g.is_partial_refresh){g.select_branch(b(g.settings.selected[h],g.container),(g.settings.rules.multiple!==false))}else{g.select_branch(b(g.settings.selected[h],g.container),(g.settings.rules.multiple!==false&&h>0))}});this.settings.selected=false}if(this.settings.ui.theme_name=="themeroller"){this.container.find("a").addClass("ui-state-default")}this.settings.callback.onload.call(null,g)},get_node:function(c){var c=b(c);return c.is("li")?c:c.parents("li:eq(0)")},get_type:function(d){d=!d?this.selected:this.get_node(d);if(!d){return}if(this.settings.rules.metadata){b.metadata.setType("attr",this.settings.rules.metadata);var c=d.metadata().type;if(c){return c}}return d.attr(this.settings.rules.type_attr)},scrollCheck:function(d,j){var i=this;var f=i.container;var h=i.container.offset();var e=f.scrollTop();var c=f.scrollLeft();var g=(f.get(0).scrollWidth>f.width())?40:20;if(j-h.top<20){f.scrollTop(Math.max((e-i.settings.ui.scroll_spd),0))}if(f.height()-(j-h.top)<g){f.scrollTop(e+i.settings.ui.scroll_spd)}if(d-h.left<20){f.scrollLeft(Math.max((c-i.settings.ui.scroll_spd),0))}if(f.width()-(d-h.left)<40){f.scrollLeft(c+i.settings.ui.scroll_spd)}if(f.scrollLeft()!=c||f.scrollTop()!=e){i.moveType=false;i.moveRef=false;a.drag_drop.marker.hide()}a.drag_drop.scroll_time=setTimeout(function(){i.scrollCheck(d,j)},50)},check:function(k,c){if(this.locked){return this.error("LOCKED")}if(k!="dragrules"&&this.settings.rules.use_inline&&this.settings.rules.metadata){b.metadata.setType("attr",this.settings.rules.metadata);if(typeof this.get_node(c).metadata()[k]!="undefined"){return this.get_node(c).metadata()[k]}}if(!this.settings.rules[k]){return false}if(this.settings.rules[k]=="none"){return false}if(this.settings.rules[k]=="all"){return true}if(k=="dragrules"){var h=new Array();h[0]=this.get_type(c[0]);h[1]=c[1];h[2]=this.get_type(c[2]);for(var f=0;f<this.settings.rules.dragrules.length;f++){var g=this.settings.rules.dragrules[f];var l=(g.indexOf("!")===0)?false:true;if(!l){g=g.replace("!","")}var e=g.split(" ");for(var d=0;d<3;d++){if(e[d]==h[d]||e[d]=="*"){e[d]=true}}if(e[0]===true&&e[1]===true&&e[2]===true){return l}}return false}else{return(b.inArray(this.get_type(c),this.settings.rules[k])!=-1)?true:false}},hover_branch:function(g){if(this.locked){return this.error("LOCKED")}if(this.settings.ui.hover_mode==false&&this.settings.ui.theme_name!="themeroller"){return this.select_branch(g)}var h=this;var g=h.get_node(g);if(!g.size()){return this.error("HOVER: NOT A VALID NODE")}if(!h.check("clickable",g)){return this.error("SELECT: NODE NOT SELECTABLE")}if(this.hovered){this.hovered.children("A").removeClass("hover ui-state-hover")}this.hovered=g;this.hovered.children("a").removeClass("hover ui-state-hover").addClass(this.settings.ui.theme_name=="themeroller"?"hover ui-state-hover":"hover");var d=this.hovered.offset().top;var c=this.container.offset().top;var e=c+this.container.height();var f=(this.container.get(0).scrollWidth>this.container.width())?40:20;if(d+5<c){this.container.scrollTop(this.container.scrollTop()-(c-d+5))}if(d+f>e){this.container.scrollTop(this.container.scrollTop()+(d+f-e))}},select_branch:function(j,c){if(this.locked){return this.error("LOCKED")}if(!j&&this.hovered!==false){j=this.hovered}var k=this;j=k.get_node(j);if(!j.size()){return this.error("SELECT: NOT A VALID NODE")}j.children("a").removeClass("hover ui-state-hover");if(!k.check("clickable",j)){return this.error("SELECT: NODE NOT SELECTABLE")}if(k.settings.callback.beforechange.call(null,j.get(0),k)===false){return this.error("SELECT: STOPPED BY USER")}if(this.settings.rules.multiple!=false&&c&&j.children("a.clicked").size()>0){return this.deselect_branch(j)}if(this.settings.rules.multiple!=false&&c){this.selected_arr.push(j)}if(this.settings.rules.multiple!=false&&!c){for(var g in this.selected_arr){if(typeof this.selected_arr[g]=="function"){continue}this.selected_arr[g].children("A").removeClass("clicked ui-state-active");this.settings.callback.ondeselect.call(null,this.selected_arr[g].get(0),k)}this.selected_arr=[];this.selected_arr.push(j);if(this.selected&&this.selected.children("A").hasClass("clicked")){this.selected.children("A").removeClass("clicked ui-state-active");this.settings.callback.ondeselect.call(null,this.selected.get(0),k)}}if(!this.settings.rules.multiple){if(this.selected){this.selected.children("A").removeClass("clicked ui-state-active");this.settings.callback.ondeselect.call(null,this.selected.get(0),k)}}this.selected=j;if((this.settings.ui.hover_mode||this.settings.ui.theme_name=="themeroller")&&this.hovered!==false){this.hovered.children("A").removeClass("hover ui-state-hover");this.hovered=j}this.selected.children("a").removeClass("clicked ui-state-active").addClass(this.settings.ui.theme_name=="themeroller"?"clicked ui-state-active":"clicked").end().parents("li.closed").each(function(){k.open_branch(this,true)});var e=this.selected.offset().top;var d=this.container.offset().top;var f=d+this.container.height();var h=(this.container.get(0).scrollWidth>this.container.width())?40:20;if(e+5<d){this.container.scrollTop(this.container.scrollTop()-(d-e+5))}if(e+h>f){this.container.scrollTop(this.container.scrollTop()+(e+h-f))}this.set_cookie("selected");this.settings.callback.onselect.call(null,this.selected.get(0),k);this.settings.callback.onchange.call(null,this.selected.get(0),k)},deselect_branch:function(c){if(this.locked){return this.error("LOCKED")}var d=this;var c=this.get_node(c);c.children("a").removeClass("clicked ui-state-active");this.settings.callback.ondeselect.call(null,c.get(0),d);if(this.settings.rules.multiple!=false&&this.selected_arr.length>1){this.selected_arr=[];this.container.find("a.clicked").filter(":first-child").parent().each(function(){d.selected_arr.push(b(this))});if(c.get(0)==this.selected.get(0)){this.selected=this.selected_arr[0];this.set_cookie("selected")}}else{if(this.settings.rules.multiple!=false){this.selected_arr=[]}this.selected=false;this.set_cookie("selected")}if(this.selected){this.settings.callback.onchange.call(null,this.selected.get(0),d)}else{this.settings.callback.onchange.call(null,false,d)}},toggle_branch:function(c){if(this.locked){return this.error("LOCKED")}var c=this.get_node(c);if(c.hasClass("closed")){return this.open_branch(c)}if(c.hasClass("open")){return this.close_branch(c)}},open_branch:function(e,c,g){if(this.locked){return this.error("LOCKED")}var e=this.get_node(e);if(!e.size()){return this.error("OPEN: NO SUCH NODE")}if(e.hasClass("leaf")){return this.error("OPEN: OPENING LEAF NODE")}if(this.settings.data.async&&e.find("li").size()==0){if(this.settings.callback.beforeopen.call(null,e.get(0),this)===false){return this.error("OPEN: STOPPED BY USER")}var f=this;e.children("ul:eq(0)").remove().end().append("<ul><li class='last'><a class='loading' href='#'>"+(f.settings.lang.loading||"Loading ...")+"</a></li></ul>");e.removeClass("closed").addClass("open");if(this.settings.data.type=="xml_flat"||this.settings.data.type=="xml_nested"){var d=(this.settings.data.type=="xml_flat")?"flat.xsl":"nested.xsl";e.children("ul:eq(0)").getTransform(this.path+d,this.settings.data.url,{params:{theme_path:f.theme},meth:this.settings.data.method,dat:this.settings.data.async_data(e,this),repl:true,callback:function(i,h){if(i.length<15){e.removeClass("closed").removeClass("open").addClass("leaf").children("ul").remove();if(g){g.call()}return}f.open_branch.apply(f,[e]);if(g){g.call()}},error:function(){e.removeClass("open").addClass("closed").children("ul:eq(0)").remove()}})}else{b.akfAjax({type:this.settings.data.method,url:this.settings.data.url,data:this.settings.data.async_data(e,this),dataType:"json",success:function(j,l){j=f.settings.callback.onJSONdata.call(null,j,f);if(!j||j.length==0){e.removeClass("closed").removeClass("open").addClass("leaf").children("ul").remove();if(g){g.call()}return}var k="";if(j.length){for(var h=0;h<j.length;h++){k+=f.parseJSON(j[h])}}else{k=f.parseJSON(j)}if(k.length>0){e.children("ul:eq(0)").replaceWith("<ul>"+k+"</ul>");e.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed");e.find("li").not(".open").not(".closed").addClass("leaf");f.open_branch.apply(f,[e])}else{e.removeClass("closed").removeClass("open").addClass("leaf").children("ul").remove()}if(g){g.call()}},error:function(i,j,h){e.removeClass("open").addClass("closed").children("ul:eq(0)").remove();f.error(h+" "+j)}})}return true}else{if(!this.settings.data.async){if(this.settings.callback.beforeopen.call(null,e.get(0),this)===false){return this.error("OPEN: STOPPED BY USER")}}if(this.settings.ui.theme_name=="themeroller"){e.find("a").not(".ui-state-default").addClass("ui-state-default")}if(parseInt(this.settings.ui.animation)>0&&!c){e.children("ul:eq(0)").css("display","none");e.removeClass("closed").addClass("open");e.children("ul:eq(0)").slideDown(parseInt(this.settings.ui.animation),function(){b(this).css("display","");if(g){g.call()}})}else{e.removeClass("closed").addClass("open");if(g){g.call()}}this.set_cookie("open");this.settings.callback.onopen.call(null,e.get(0),this);return true}},close_branch:function(d,c){if(this.locked){return this.error("LOCKED")}var e=this;var d=this.get_node(d);if(!d.size()){return this.error("CLOSE: NO SUCH NODE")}if(e.settings.callback.beforeclose.call(null,d.get(0),e)===false){return this.error("CLOSE: STOPPED BY USER")}if(parseInt(this.settings.ui.animation)>0&&!c&&d.children("ul:eq(0)").size()==1){d.children("ul:eq(0)").slideUp(parseInt(this.settings.ui.animation),function(){if(d.hasClass("open")){d.removeClass("open").addClass("closed")}e.set_cookie("open");b(this).css("display","")})}else{if(d.hasClass("open")){d.removeClass("open").addClass("closed")}this.set_cookie("open")}if(this.selected&&d.children("ul:eq(0)").find("a.clicked").size()>0){d.find("li:has(a.clicked)").each(function(){e.deselect_branch(this)});if(d.children("a.clicked").size()==0){this.select_branch(d,(this.settings.rules.multiple!=false&&this.selected_arr.length>0))}}this.settings.callback.onclose.call(null,d.get(0),this)},open_all:function(d,f){if(this.locked){return this.error("LOCKED")}var e=this;d=d?this.get_node(d).parent():this.container;var c=d.find("li.closed").size();if(!f){this.cl_count=0}else{this.cl_count--}if(c>0){this.cl_count+=c;d.find("li.closed").each(function(){var g=this;e.open_branch.apply(e,[this,true,function(){e.open_all.apply(e,[g,true])}])})}else{if(this.cl_count==0){this.settings.callback.onopen_all.call(null,this)}}},close_all:function(){if(this.locked){return this.error("LOCKED")}var c=this;this.container.find("li.open").each(function(){c.close_branch(this,true)})},show_lang:function(d){if(this.locked){return this.error("LOCKED")}if(this.settings.languages[d]==this.current_lang){return true}var c=false;var e=this.container.attr("id")?"#"+this.container.attr("id"):".tree";c=get_css(e+" ."+this.current_lang,this.sn);if(c!==false){c.style.display="none"}c=get_css(e+" ."+this.settings.languages[d],this.sn);if(c!==false){c.style.display=""}this.current_lang=this.settings.languages[d];return true},cycle_lang:function(){if(this.locked){return this.error("LOCKED")}var c=b.inArray(this.current_lang,this.settings.languages);c++;if(c>this.settings.languages.length-1){c=0}this.show_lang(c)},create:function(d,h,f){if(this.locked){return this.error("LOCKED")}var n=false;if(h==-1){n=true;h=this.container}else{h=h?this.get_node(h):this.selected}if(!n&&(!h||!h.size())){return this.error("CREATE: NO NODE SELECTED")}var m=f;var e=h;if(f=="before"){f=h.parent().children().index(h);h=h.parents("li:eq(0)")}if(f=="after"){f=h.parent().children().index(h)+1;h=h.parents("li:eq(0)")}if(!n&&h.size()==0){n=true;h=this.container}if(!n){if(!this.check("creatable",h)){return this.error("CREATE: CANNOT CREATE IN NODE")}if(h.hasClass("closed")){if(this.settings.data.async&&h.children("ul").size()==0){var g=this;return this.open_branch(h,true,function(){g.create.apply(g,[d,h,f])})}else{this.open_branch(h,true)}}}var j=false;if(!d){d={}}else{d=b.extend(true,{},d)}if(!d.attributes){d.attributes={}}if(this.settings.rules.metadata){if(!d.attributes[this.settings.rules.metadata]){d.attributes[this.settings.rules.metadata]='{ "type" : "'+(this.get_type(e)||"")+'" }'}}else{if(!d.attributes[this.settings.rules.type_attr]){d.attributes[this.settings.rules.type_attr]=this.get_type(e)||""}}if(this.settings.languages.length){if(!d.data){d.data={};j=true}for(var c=0;c<this.settings.languages.length;c++){if(!d.data[this.settings.languages[c]]){d.data[this.settings.languages[c]]=((typeof this.settings.lang.new_node).toLowerCase()!="string"&&this.settings.lang.new_node[c])?this.settings.lang.new_node[c]:this.settings.lang.new_node}}}else{if(!d.data){d.data=this.settings.lang.new_node;j=true}}var k=b(this.parseJSON(d));if(k.children("ul").size()){if(!k.is(".open")){k.addClass("closed")}}else{k.addClass("leaf")}k.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed");k.find("li").not(".open").not(".closed").addClass("leaf");if(!n&&this.settings.rules.use_inline&&this.settings.rules.metadata){var p=this.get_type(k)||"";b.metadata.setType("attr",this.settings.rules.metadata);if(typeof h.metadata()["valid_children"]!="undefined"){if(b.inArray(p,h.metadata()["valid_children"])==-1){return this.error("CREATE: NODE NOT A VALID CHILD")}}if(typeof h.metadata()["max_children"]!="undefined"){if((h.children("ul:eq(0)").children("li").size()+1)>h.metadata().max_children){return this.error("CREATE: MAX_CHILDREN REACHED")}}var l=true;if((typeof b(h).metadata().max_depth).toLowerCase()!="undefined"&&b(h).metadata().max_depth===0){l=false}else{h.parents("li").each(function(q){if(b(this).metadata().max_depth){if((q+1)>=b(this).metadata().max_depth){l=false;return false}}})}if(!l){return this.error("CREATE: MAX_DEPTH REACHED")}}if((typeof f).toLowerCase()=="undefined"||f=="inside"){f=(this.settings.rules.createat=="top")?0:h.children("ul:eq(0)").children("li").size()}if(h.children("ul").size()==0||(n==true&&h.children("ul").children("li").size()==0)){if(!n){var o=this.moved(k,h.children("a:eq(0)"),"inside",true)}else{var o=this.moved(k,this.container.children("ul:eq(0)"),"inside",true)}}else{if(m=="before"&&h.children("ul:eq(0)").children("li:nth-child("+(f+1)+")").size()){var o=this.moved(k,h.children("ul:eq(0)").children("li:nth-child("+(f+1)+")").children("a:eq(0)"),"before",true)}else{if(m=="after"&&h.children("ul:eq(0)").children("li:nth-child("+(f)+")").size()){var o=this.moved(k,h.children("ul:eq(0)").children("li:nth-child("+(f)+")").children("a:eq(0)"),"after",true)}else{if(h.children("ul:eq(0)").children("li:nth-child("+(f+1)+")").size()){var o=this.moved(k,h.children("ul:eq(0)").children("li:nth-child("+(f+1)+")").children("a:eq(0)"),"before",true)}else{var o=this.moved(k,h.children("ul:eq(0)").children("li:last").children("a:eq(0)"),"after",true)}}}}if(o===false){return this.error("CREATE: ABORTED")}if(j){this.select_branch(k.children("a:eq(0)"));this.rename()}return k},rename:function(e){if(this.locked){return this.error("LOCKED")}e=e?this.get_node(e):this.selected;var f=this;if(!e||!e.size()){return this.error("RENAME: NO NODE SELECTED")}if(!this.check("renameable",e)){return this.error("RENAME: NODE NOT RENAMABLE")}if(!this.settings.callback.beforerename.call(null,e.get(0),f.current_lang,f)){return this.error("RENAME: STOPPED BY USER")}e.parents("li.closed").each(function(){f.open_branch(this)});if(this.current_lang){e=e.find("a."+this.current_lang).get(0)}else{e=e.find("a:first").get(0)}last_value=e.innerHTML;f.inp=b("<input type='text' autocomplete='off' />");f.inp.val(last_value.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<")).bind("mousedown",function(g){g.stopPropagation()}).bind("mouseup",function(g){g.stopPropagation()}).bind("click",function(g){g.stopPropagation()}).bind("keyup",function(h){var g=h.keyCode||h.which;if(g==27){this.value=last_value;this.blur();return}if(g==13){this.blur();return}});var d={};d[this.container.attr("id")]=this.get_rollback();f.inp.blur(function(g){if(this.value==""){this.value=last_value}b(e).text(b(e).parent().find("input").eq(0).attr("value")).get(0).style.display="";b(e).prevAll("span").remove();f.settings.callback.onrename.call(null,f.get_node(e).get(0),f.current_lang,f,d);f.inp=false});var c=b("<span />").addClass(e.className).append(f.inp);c.attr("style",b(e).attr("style"));e.style.display="none";b(e).parent().prepend(c);f.inp.get(0).focus();f.inp.get(0).select()},remove:function(f){if(this.locked){return this.error("LOCKED")}var e={};e[this.container.attr("id")]=this.get_rollback();if(f&&(!this.selected||this.get_node(f).get(0)!=this.selected.get(0))){f=this.get_node(f);if(f.size()){if(!this.check("deletable",f)){return this.error("DELETE: NODE NOT DELETABLE")}if(!this.settings.callback.beforedelete.call(null,f.get(0),g)){return this.error("DELETE: STOPPED BY USER")}$parent=f.parent();f=f.remove();$parent.children("li:last").addClass("last");if($parent.children("li").size()==0){$li=$parent.parents("li:eq(0)");$li.removeClass("open").removeClass("closed").addClass("leaf").children("ul").remove();this.set_cookie("open")}this.settings.callback.ondelete.call(null,f.get(0),this,e)}}else{if(this.selected){if(!this.check("deletable",this.selected)){return this.error("DELETE: NODE NOT DELETABLE")}if(!this.settings.callback.beforedelete.call(null,this.selected.get(0),g)){return this.error("DELETE: STOPPED BY USER")}$parent=this.selected.parent();var f=this.selected;if(this.settings.rules.multiple==false||this.selected_arr.length==1){var d=true;var c=(this.selected.prev("li:eq(0)").size())?this.selected.prev("li:eq(0)"):this.selected.parents("li:eq(0)")}f=f.remove();$parent.children("li:last").addClass("last");if($parent.children("li").size()==0){$li=$parent.parents("li:eq(0)");$li.removeClass("open").removeClass("closed").addClass("leaf").children("ul").remove();this.set_cookie("open")}this.settings.callback.ondelete.call(null,f.get(0),this,e);if(d&&c){this.select_branch(c)}if(this.settings.rules.multiple!=false&&!d){var g=this;this.selected_arr=[];this.container.find("a.clicked").filter(":first-child").parent().each(function(){g.selected_arr.push(b(this))});if(this.selected_arr.length>0){this.selected=this.selected_arr[0];this.remove()}}}else{return this.error("DELETE: NO NODE SELECTED")}}},next:function(d,c){d=this.get_node(d);if(!d.size()){return false}if(c){return(d.nextAll("li").size()>0)?d.nextAll("li:eq(0)"):false}if(d.hasClass("open")){return d.find("li:eq(0)")}else{if(d.nextAll("li").size()>0){return d.nextAll("li:eq(0)")}else{return d.parents("li").next("li").eq(0)}}},prev:function(d,c){d=this.get_node(d);if(!d.size()){return false}if(c){return(d.prevAll("li").size()>0)?d.prevAll("li:eq(0)"):false}if(d.prev("li").size()){var d=d.prev("li").eq(0);while(d.hasClass("open")){d=d.children("ul:eq(0)").children("li:last")}return d}else{return d.parents("li:eq(0)").size()?d.parents("li:eq(0)"):false}},parent:function(c){c=this.get_node(c);if(!c.size()){return false}return c.parents("li:eq(0)").size()?c.parents("li:eq(0)"):false},children:function(c){c=this.get_node(c);if(!c.size()){return false}return c.children("ul:eq(0)").children("li")},get_next:function(c){var d=this.hovered||this.selected;return c?this.select_branch(this.next(d)):this.hover_branch(this.next(d))},get_prev:function(c){var d=this.hovered||this.selected;return c?this.select_branch(this.prev(d)):this.hover_branch(this.prev(d))},get_left:function(c,e){if(this.settings.ui.rtl&&!e){return this.get_right(c,true)}var d=this.hovered||this.selected;if(d){if(d.hasClass("open")){this.close_branch(d)}else{return c?this.select_branch(this.parent(d)):this.hover_branch(this.parent(d))}}},get_right:function(c,e){if(this.settings.ui.rtl&&!e){return this.get_left(c,true)}var d=this.hovered||this.selected;if(d){if(d.hasClass("closed")){this.open_branch(d)}else{return c?this.select_branch(d.find("li:eq(0)")):this.hover_branch(d.find("li:eq(0)"))}}},toggleDots:function(){if(this.settings.ui.dots){this.settings.ui.dots=false;this.container.children("ul:eq(0)").addClass("no_dots")}else{this.settings.ui.dots=true;this.container.children("ul:eq(0)").removeClass("no_dots")}},toggleRTL:function(){if(this.settings.ui.rtl){this.settings.ui.rtl=false;this.container.css("direction","ltr").children("ul:eq(0)").removeClass("rtl").addClass("ltr")}else{this.settings.ui.rtl=true;this.container.css("direction","rtl").children("ul:eq(0)").removeClass("ltr").addClass("rtl")}},set_cookie:function(c){if(this.settings.cookies===false){return false}if(this.settings.cookies[c]===false){return false}switch(c){case"selected":if(this.settings.rules.multiple!=false&&this.selected_arr.length>1){var e=Array();b.each(this.selected_arr,function(){if(this.attr("id")){e.push(this.attr("id"))}});e=e.join(",")}else{var e=this.selected?this.selected.attr("id"):false}b.cookie(this.settings.cookies.prefix+"_selected",e,this.settings.cookies.opts);break;case"open":var d="";this.container.find("li.open").each(function(f){if(this.id){d+=this.id+","}});b.cookie(this.settings.cookies.prefix+"_open",d.replace(/,$/ig,""),this.settings.cookies.opts);break}},get_rollback:function(){var c={};if(this.context.to_remove&&this.context.apply_to){this.context.apply_to.children("a").removeClass("clicked")}c.html=this.container.html();if(this.context.to_remove&&this.context.apply_to){this.context.apply_to.children("a").addClass("clicked")}c.selected=this.selected?this.selected.attr("id"):false;return c},moved:function(p,l,q,c,r,d){var p=b(p);var f=b(p).parents("ul:eq(0)");var g=b(l);if(!d){var d={};d[this.container.attr("id")]=this.get_rollback();if(!c){var k=p.size()>1?p.eq(0).parents(".tree:eq(0)"):p.parents(".tree:eq(0)");if(k.get(0)!=this.container.get(0)){k=a.inst[k.attr("id")];d[k.container.attr("id")]=k.get_rollback()}delete k}}if(q=="inside"&&this.settings.data.async&&this.get_node(g).hasClass("closed")){var m=this;return this.open_branch(this.get_node(g),true,function(){m.moved.apply(m,[p,l,q,c,r,d])})}if(p.size()>1){var m=this;var k=this.moved(p.eq(0),l,q,false,r,d);p.each(function(j){if(j==0){return}if(k){k=m.moved(this,k.children("a:eq(0)"),"after",false,r,d)}});return}if(r){_what=p.clone();_what.each(function(j){this.id=this.id+"_copy";b(this).find("li").each(function(){this.id=this.id+"_copy"});b(this).removeClass("dragged").find("a.clicked").removeClass("clicked ui-state-active").end().find("li.dragged").removeClass("dragged")})}else{_what=p}if(c){if(!this.settings.callback.beforecreate.call(null,this.get_node(p).get(0),this.get_node(l).get(0),q,this)){return false}}else{if(!this.settings.callback.beforemove.call(null,this.get_node(p).get(0),this.get_node(l).get(0),q,this)){return false}}if(!c){var k=p.parents(".tree:eq(0)");if(k.get(0)!=this.container.get(0)){k=a.inst[k.attr("id")];if(k.settings.languages.length){var n=[];if(this.settings.languages.length==0){n.push("."+k.current_lang)}else{for(var h in this.settings.languages){if(typeof this.settings.languages[h]=="function"){continue}for(var e in k.settings.languages){if(typeof k.settings.languages[e]=="function"){continue}if(this.settings.languages[h]==k.settings.languages[e]){n.push("."+this.settings.languages[h])}}}}if(n.length==0){return this.error("MOVE: NO COMMON LANGUAGES")}p.find("a").not(n.join(",")).remove()}p.find("a.clicked").removeClass("clicked ui-state-active")}}p=_what;switch(q){case"before":g.parents("ul:eq(0)").children("li.last").removeClass("last");g.parent().before(p.removeClass("last"));g.parents("ul:eq(0)").children("li:last").addClass("last");break;case"after":g.parents("ul:eq(0)").children("li.last").removeClass("last");g.parent().after(p.removeClass("last"));g.parents("ul:eq(0)").children("li:last").addClass("last");break;case"inside":if(g.parent().children("ul:first").size()){if(this.settings.rules.createat=="top"){g.parent().children("ul:first").prepend(p.removeClass("last")).children("li:last").addClass("last")}else{g.parent().children("ul:first").children(".last").removeClass("last").end().append(p.removeClass("last")).children("li:last").addClass("last")}}else{p.addClass("last");g.parent().append("<ul/>").removeClass("leaf").addClass("closed");g.parent().children("ul:first").prepend(p)}if(g.parent().hasClass("closed")){this.open_branch(g)}break;default:break}if(f.find("li").size()==0){var o=f.parent();o.removeClass("open").removeClass("closed").addClass("leaf");if(!o.is(".tree")){o.children("ul").remove()}o.parents("ul:eq(0)").children("li.last").removeClass("last").end().children("li:last").addClass("last");this.set_cookie("open")}else{f.children("li.last").removeClass("last");f.children("li:last").addClass("last")}if(r){this.settings.callback.oncopy.call(null,this.get_node(p).get(0),this.get_node(l).get(0),q,this,d)}else{if(c){this.settings.callback.oncreate.call(null,this.get_node(p).get(0),(g.is("ul")?-1:this.get_node(l).get(0)),q,this,d)}else{this.settings.callback.onmove.call(null,this.get_node(p).get(0),this.get_node(l).get(0),q,this,d)}}return p},error:function(c){this.settings.callback.error.call(null,c,this);return false},lock:function(c){this.locked=c;if(this.locked){this.container.children("ul:eq(0)").addClass("locked")}else{this.container.children("ul:eq(0)").removeClass("locked")}},cut:function(c){if(this.locked){return this.error("LOCKED")}c=c?this.get_node(c):this.container.find("a.clicked").filter(":first-child").parent();if(!c||!c.size()){return this.error("CUT: NO NODE SELECTED")}this.copy_nodes=false;this.cut_nodes=c},copy:function(c){if(this.locked){return this.error("LOCKED")}c=c?this.get_node(c):this.container.find("a.clicked").filter(":first-child").parent();if(!c||!c.size()){return this.error("COPY: NO NODE SELECTED")}this.copy_nodes=c;this.cut_nodes=false},paste:function(g,c){if(this.locked){return this.error("LOCKED")}var e=false;if(g==-1){e=true;g=this.container}else{g=g?this.get_node(g):this.selected}if(!e&&(!g||!g.size())){return this.error("PASTE: NO NODE SELECTED")}if(!this.copy_nodes&&!this.cut_nodes){return this.error("PASTE: NOTHING TO DO")}var i=this;var h=c;if(c=="before"){c=g.parent().children().index(g);g=g.parents("li:eq(0)")}else{if(c=="after"){c=g.parent().children().index(g)+1;g=g.parents("li:eq(0)")}else{if((typeof c).toLowerCase()=="undefined"||c=="inside"){c=(this.settings.rules.createat=="top")?0:g.children("ul:eq(0)").children("li").size()}}}if(!e&&g.size()==0){e=true;g=this.container}if(this.copy_nodes&&this.copy_nodes.size()){var f=true;if(!f){return this.error("Invalid paste")}if(!e&&!this.checkMove(this.copy_nodes,g.children("a:eq(0)"),"inside")){return false}if(g.children("ul").size()==0||(e==true&&g.children("ul").children("li").size()==0)){if(!e){var d=this.moved(this.copy_nodes,g.children("a:eq(0)"),"inside",false,true)}else{var d=this.moved(this.copy_nodes,this.container.children("ul:eq(0)"),"inside",false,true)}}else{if(h=="before"&&g.children("ul:eq(0)").children("li:nth-child("+(c+1)+")").size()){var d=this.moved(this.copy_nodes,g.children("ul:eq(0)").children("li:nth-child("+(c+1)+")").children("a:eq(0)"),"before",false,true)}else{if(h=="after"&&g.children("ul:eq(0)").children("li:nth-child("+(c)+")").size()){var d=this.moved(this.copy_nodes,g.children("ul:eq(0)").children("li:nth-child("+(c)+")").children("a:eq(0)"),"after",false,true)}else{if(g.children("ul:eq(0)").children("li:nth-child("+(c+1)+")").size()){var d=this.moved(this.copy_nodes,g.children("ul:eq(0)").children("li:nth-child("+(c+1)+")").children("a:eq(0)"),"before",false,true)}else{var d=this.moved(this.copy_nodes,g.children("ul:eq(0)").children("li:last").children("a:eq(0)"),"after",false,true)}}}}this.copy_nodes=false}if(this.cut_nodes&&this.cut_nodes.size()){var f=true;g.parents().andSelf().each(function(){if(i.cut_nodes.index(this)!=-1){f=false;return false}});if(!f){return this.error("Invalid paste")}if(!e&&!this.checkMove(this.cut_nodes,g.children("a:eq(0)"),"inside")){return false}if(g.children("ul").size()==0||(e==true&&g.children("ul").children("li").size()==0)){if(!e){var d=this.moved(this.cut_nodes,g.children("a:eq(0)"),"inside")}else{var d=this.moved(this.cut_nodes,this.container.children("ul:eq(0)"),"inside")}}else{if(h=="before"&&g.children("ul:eq(0)").children("li:nth-child("+(c+1)+")").size()){var d=this.moved(this.cut_nodes,g.children("ul:eq(0)").children("li:nth-child("+(c+1)+")").children("a:eq(0)"),"before")}else{if(h=="after"&&g.children("ul:eq(0)").children("li:nth-child("+(c)+")").size()){var d=this.moved(this.cut_nodes,g.children("ul:eq(0)").children("li:nth-child("+(c)+")").children("a:eq(0)"),"after")}else{if(g.children("ul:eq(0)").children("li:nth-child("+(c+1)+")").size()){var d=this.moved(this.cut_nodes,g.children("ul:eq(0)").children("li:nth-child("+(c+1)+")").children("a:eq(0)"),"before")}else{var d=this.moved(this.cut_nodes,g.children("ul:eq(0)").children("li:last").children("a:eq(0)"),"after")}}}}this.cut_nodes=false}},search:function(g){var i=this;if(!g||(this.srch&&g!=this.srch)){this.srch="";this.srch_opn=false;this.container.find("a.search").removeClass("search ui-state-highlight")}this.srch=g;if(!g){return}if(this.settings.data.async){if(!this.srch_opn){var d=b.extend({search:g},this.settings.data.async_data(false,this));b.akfAjax({type:this.settings.data.method,url:this.settings.data.url,data:d,dataType:"text",success:function(j){i.srch_opn=b.unique(j.split(","));i.search.apply(i,[g])}})}else{if(this.srch_opn.length){if(this.srch_opn&&this.srch_opn.length){var h=false;for(var e=0;e<this.srch_opn.length;e++){if(this.get_node("#"+this.srch_opn[e]).size()>0){h=true;var f="#"+this.srch_opn[e];delete this.srch_opn[e];this.open_branch(f,true,function(){i.search.apply(i,[g])})}}if(!h){this.srch_opn=[];i.search.apply(i,[g])}}}else{var c="a";if(this.settings.languages.length){c+="."+this.current_lang}this.container.find(c+":contains('"+g+"')").addClass(this.settings.ui.theme_name=="themeroller"?"search ui-state-highlight":"search");this.srch_opn=false}}}else{var c="a";if(this.settings.languages.length){c+="."+this.current_lang}this.container.find(c+":contains('"+g+"')").addClass(this.settings.ui.theme_name=="themeroller"?"search ui-state-highlight":"search").parents("li.closed").each(function(){i.open_branch(this,true)})}},destroy:function(){this.hide_context();this.container.unbind(".jstree");b("#"+this.container.attr("id")).die("click.jstree").die("dblclick.jstree").die("contextmenu.jstree").die("mouseover.jstree").die("mouseout.jstree").die("mousedown.jstree");this.container.removeClass("tree ui-widget ui-widget-content tree-default tree-"+this.settings.ui.theme_name).children("ul").removeClass("no_dots rtl ltr locked").find("li").removeClass("leaf").removeClass("open").removeClass("closed").removeClass("last").children("a").removeClass("clicked hover search ui-state-active ui-state-hover ui-state-highlight ui-state-default");if(this.cntr==a.focused){for(var c in a.inst){if(c!=this.cntr&&c!=this.container.attr("id")){a.inst[c].focus();break}}}a.inst[this.cntr]=false;a.inst[this.container.attr("id")]=false;delete a.inst[this.cntr];delete a.inst[this.container.attr("id")];a.cntr--}}}})(jQuery);
